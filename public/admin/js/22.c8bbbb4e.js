(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"3caf":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-md-12"},[a("reusable-table",{attrs:{title:"Imagenes Tratamientos","api-url":"api/v1/subtreatments/resource","table-name":e.tableName,"create-route":"registry-players","create-label":"Agregar"},on:{"edit-treatment":e.editTreatment,"modal-delete-player":e.modalDeleteTreatment}})],1),a("div",{staticClass:"col-md-12"},[a("q-dialog",{attrs:{persistent:""},model:{value:e.toDelete.modal,callback:function(t){e.$set(e.toDelete,"modal",t)},expression:"toDelete.modal"}},[e.toDelete.data?a("q-card",{staticStyle:{width:"1200px","max-width":"95vw"}},[a("q-card-section",[a("h2",{staticClass:"text-subtitle1 bolder"},[e._v("Eliminar")])]),a("q-separator"),a("q-card-section",[e._v("\n          Desea eliminar el tratamiento "+e._s(e.toDelete.data.title)+"\n        ")]),a("q-separator"),a("q-card-section",{staticClass:"text-right"},[a("q-btn",{attrs:{color:"negative",flat:"",label:"Cancelar",disable:e.loadingDelete},on:{click:function(t){e.toDelete.modal=!1}}}),a("q-btn",{attrs:{color:"negative",label:"Eliminar",icon:"delete",loading:e.loadingDelete,disable:e.loadingDelete},on:{click:e.deleteTreatment},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}],null,!1,4102112682)})],1)],1):e._e()],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("q-card",{staticStyle:{width:"1350px","max-width":"95%"}},[a("q-card-section",[a("div",{staticClass:"row q-col-gutter-sm"},[a("div",{staticClass:"col-md-6"},[a("q-input",{staticClass:"q-mt-sm",attrs:{filled:"",label:"Titulo tratamiento"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),a("q-editor",{staticClass:"q-mt-md",attrs:{filled:"",placeholder:"Detalles",type:"textarea",label:"Contenido"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-xs-12"},[a("label",[e._v("Imágenes antes")])]),a("div",{staticClass:"col-xs-12 q-pr-md q-mb-md"},[a("croppa",{ref:"croppary_before",staticClass:"text-center",attrs:{height:120,width:120,multiple:"","initial-position":"center",placeholder:e.$t(""),"placeholder-font-size":19,"remove-button-size":23},on:{"new-image-drawn":function(t){return e.submitProductImage("croppary_before","before")}},model:{value:e.croppa,callback:function(t){e.croppa=t},expression:"croppa"}},[a("img",{staticClass:"img-responsive canvas-image",attrs:{slot:"placeholder",src:"/statics/placeholder.png",width:"40px"},slot:"placeholder"})])],1),a("div",{staticClass:"col-xs-12"},[e.beforeImages.length?a("div",{staticClass:"form-group"},[a("label",{domProps:{textContent:e._s(e.$t("Imágenes"))}}),a("div",{staticClass:"row"},e._l(e.beforeImages,(function(t){return a("div",{key:t.id,staticClass:"col-xs-12 col-md-6 q-pa-sm"},[a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:e.appPath+"/images/tratamientos/"+t.name}}),a("q-card-actions",[a("q-btn",{attrs:{loading:e.loadingDeleteImg,icon:"delete",flat:"",color:"negative",size:"sm",disable:e.loadingDeleteImg},on:{click:function(a){return e.deleteImage(t.id)}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}],null,!0)})],1)],1)],1)})),0)]):e._e()])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-xs-12"},[a("label",[e._v("Imágenes después")])]),a("div",{staticClass:"col-xs-12 q-pr-md q-mb-md"},[a("croppa",{ref:"croppary_after",staticClass:"text-center",attrs:{height:120,width:120,multiple:"","initial-position":"center",placeholder:e.$t(""),"placeholder-font-size":19,"remove-button-size":23},on:{"new-image-drawn":function(t){return e.submitProductImage("croppary_after","after")}},model:{value:e.croppa,callback:function(t){e.croppa=t},expression:"croppa"}},[a("img",{staticClass:"img-responsive canvas-image",attrs:{slot:"placeholder",src:"/statics/placeholder.png",width:"40px"},slot:"placeholder"})])],1),a("div",{staticClass:"col-xs-12"},[e.afterImages.length?a("div",{staticClass:"form-group"},[a("label",{domProps:{textContent:e._s(e.$t("Imágenes"))}}),a("div",{staticClass:"row"},e._l(e.afterImages,(function(t){return a("div",{key:t.id,staticClass:"col-xs-12 col-md-6 q-pa-sm"},[a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:e.appPath+"/images/tratamientos/"+t.name}}),a("q-card-actions",[a("q-btn",{attrs:{loading:e.loadingDeleteImg,icon:"delete",flat:"",color:"negative",size:"sm",disable:e.loadingDeleteImg},on:{click:function(a){return e.deleteImage(t.id)}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}],null,!0)})],1)],1)],1)})),0)]):e._e()])])])])]),a("q-card-section",{staticClass:"text-right"},[a("q-btn",{attrs:{label:"Cerrar",color:"primary",flat:""},on:{click:function(t){e.showModal=!1}}}),a("q-btn",{attrs:{disable:e.loadingSave,icon:"save",label:"Guardar",color:"primary"},on:{click:e.save}})],1)],1)],1)],1)},i=[],n=a("967e"),r=a.n(n),o=(a("96cf"),a("fa84")),l=a.n(o),c=(a("a481"),a("3786")),d=a("d66b"),m=a("2b0e"),u=a("b185"),p=a("2896"),f=a.n(p),g=a("b5ae");g.required,g.minLength;m["a"].use(f.a);var v={name:"ImagesTreatmentsTable",components:{QRadio:c["a"],ReusableTable:u["default"],QEditor:d["a"]},data:function(){return{croppa:{},croppaTwo:{},loadingDelete:!1,servis:[],loadingSave:!1,toDelete:{data:null,modal:!1},form:{for_images:!0,treatment:{id:20,value:20},type:"treatment",title:null,id:null,oldImages:[],description:""},loadingDeleteImg:!1,tableName:"images-treatments-table",columns:[{name:"title",field:"title",label:"Titulo"},{name:"actions",field:"actions",label:"Acciones"}],playersData:[],filtersBag:[{name:"for_images",value:!0}],loading:!1,submitOnChange:!0,showModal:!1,moreParams:{for_images:!1,selected:[],sortBy:"desc",descending:!1,page:1,rowsNumber:10,rowsPerPage:500,total:5e3}}},mounted:function(){this.getTreat(),0==window.location.hostname.indexOf("www")&&(window.location=window.location.href.replace("www.",""))},computed:{appPath:function(){return"https://sabrinalainatti.com"},afterImages:function(){return this.form.oldImages.filter((function(e){return"after"===e.kind}))},beforeImages:function(){return this.form.oldImages.filter((function(e){return"before"===e.kind}))}},methods:{getTreat:function(){var e=this;return l()(r.a.mark((function t(){var a;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.$axios.post("api/v1/treatments/forSelect");case 4:a=t.sent,e.servis=a.data,t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,e.loading=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,8,10,13]])})))()},deleteImage:function(e){var t=this;return l()(r.a.mark((function a(){var s,i;return r.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadingDeleteImg=!0,a.prev=1,a.next=4,t.$axios.post("api/v1/images/delete",{service_id:null,subtreatment_id:null!==(s=t.form.id)&&void 0!==s?s:null,image_id:e});case 4:i=a.sent,t.form.oldImages=i.data.images,t.$events.fire("notify",i.data.msg),a.next=11;break;case 9:a.prev=9,a.t0=a["catch"](1);case 11:t.loadingDeleteImg=!1;case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},submitProductImage:function(e,t){var a=this;return l()(r.a.mark((function s(){var i;return r.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a.$refs[e].hasImage()){s.next=2;break}return s.abrupt("return");case 2:i=a,a.$refs[e].generateBlob((function(s){if(a.submitOnChange){var n,r=new FormData;r.append("image",a.$refs[e].getChosenFile()),r.append("service_id",null),r.append("subtreatment_id",null!==(n=a.form.id)&&void 0!==n?n:null),r.append("kind",t),r.append("type","service"),i.$q.loading.show({message:"Cargando imagen ..."}),i.$axios.post("api/v1/images/resource",r).then((function(t){i.$q.loading.hide(),i.$events.fire("notify",i.$t(t.data.msg)),t.data.error||(i.$refs[e].remove(),i.form.oldImages=t.data.images)})).catch((function(e){i.$q.loading.hide()}))}else a.$events.fire("image-change",s)}));case 4:case"end":return s.stop()}}),s)})))()},editTreatment:function(){var e,t=arguments.length>1?arguments[1]:void 0;this.showModal=!0,this.form.id=t.id,this.form.title=t.title,this.form.oldImages=t.images,this.form.description=null!==(e=t.description)&&void 0!==e?e:""},setIcon:function(e){this.form.icon=e.title},save:function(){var e=this;return l()(r.a.mark((function t(){var a;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loadingSave=!0,e.$q.loading.show({message:"Guardando ..."}),t.next=5,e.$axios.post("api/v1/subtreatments/resource",e.form);case 5:a=t.sent,!1===a.data.error&&(e.showModal=!1),e.$q.loading.hide(),e.$events.fire("notify",a.data.msg),e.$events.fire("get-data"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),e.$q.loading.hide();case 15:return t.prev=15,e.loadingSave=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})))()},modalDeleteTreatment:function(){var e=arguments.length>1?arguments[1]:void 0;this.toDelete.data=e,this.toDelete.modal=!0},deleteTreatment:function(){var e=this;return l()(r.a.mark((function t(){var a;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loadingDelete=!0,t.next=4,e.$axios.post("api/v1/subtreatments/delete",{subtreatment_id:e.toDelete.data.id});case 4:a=t.sent,e.$events.fire("notify",a.data.msg),!1===a.data.error&&(e.toDelete.modal=!1,e.$events.fire("get-data")),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:return t.prev=11,e.loadingDelete=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,9,11,14]])})))()}},events:{"create-treatment":function(){this.showModal=!0,this.form.title=null,this.form.type="service",this.form.oldImages=[],this.form.description="",this.form.id=null},"edit-treatment":function(e,t){}}},h=v,b=(a("59f1"),a("2877")),w=Object(b["a"])(h,s,i,!1,null,"61877022",null);t["default"]=w.exports},"59f1":function(e,t,a){"use strict";var s=a("5cd5"),i=a.n(s);i.a},"5cd5":function(e,t,a){}}]);