(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{"0ea9":function(e,t,a){},"36be":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-md-12"},[a("reusable-table",{attrs:{title:"Tratamientos / servicios","api-url":"api/v1/treatments/resource","table-name":e.tableName,"create-route":"registry-players","create-label":"Agregar"},on:{"edit-treatment":e.editTreatment,"modal-delete-player":e.modalDeleteTreatment}})],1),a("div",{staticClass:"col-md-12"},[a("q-dialog",{attrs:{persistent:""},model:{value:e.toDelete.modal,callback:function(t){e.$set(e.toDelete,"modal",t)},expression:"toDelete.modal"}},[e.toDelete.data?a("q-card",{staticStyle:{width:"600px","max-width":"90vw"}},[a("q-card-section",[a("h2",{staticClass:"text-subtitle1 bolder"},[e._v("Eliminar")])]),a("q-separator"),a("q-card-section",[e._v("\n          Desea eliminar el tratamiento "+e._s(e.toDelete.data.title)+"\n        ")]),a("q-separator"),a("q-card-section",{staticClass:"text-right"},[a("q-btn",{attrs:{color:"negative",flat:"",label:"Cancelar",disable:e.loading},on:{click:function(t){e.toDelete.modal=!1}}}),a("q-btn",{attrs:{color:"negative",label:"Eliminar",icon:"delete",loading:e.loadingDelete,disable:e.loadingDelete},on:{click:e.deleteTreatment},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}],null,!1,4102112682)})],1)],1):e._e()],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("q-card",{staticStyle:{width:"1200px","max-width":"95%"}},[a("q-card-section",[a("div",{staticClass:"row q-col-gutter-sm"},[a("div",{staticClass:"col-md-7"},[a("q-radio",{attrs:{val:"service",label:"Servicio",error:e.$v.form.type.$error},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}),a("q-radio",{attrs:{val:"treatment",label:"Tratamiento",error:e.$v.form.type.$error},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}),a("q-input",{attrs:{filled:"",label:"Titulo",error:e.$v.form.title.$error},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),"service"===e.form.type?a("q-editor",{staticClass:"q-mt-md",attrs:{"min-height":"5rem",filled:"",label:"Descripción tratamiento"},model:{value:e.form.contents,callback:function(t){e.$set(e.form,"contents",t)},expression:"form.contents"}}):e._e()],1),a("div",{staticClass:"col-md-5"},[a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col-md-12"},[a("label",{attrs:{for:""}},[e._v("Seleccionar ícono")])]),e._l(e.icons,(function(t,i){return a("div",{key:i,staticClass:"col-md-3 text-center"},[a("q-btn",{attrs:{flat:""},on:{click:function(a){return e.setIcon(t)}}},[a("img",{staticClass:"icon q-mt-md q-mb-sm",staticStyle:{"max-width":"40px"},attrs:{src:"statics/miniicons/"+t.title,alt:""}})]),a("br"),e.form.icon===t.title?a("small",{staticClass:"text-positive"},[e._v("SELECCIONADO")]):e._e()],1)}))],2),"service"===e.form.type?a("div",{staticClass:"row"},[a("div",{staticClass:"col-xs-12"},[a("label",[e._v("Imagen lateral izquierda")])]),0===e.leftImages.length?a("div",{staticClass:"col-xs-12 col-md-4 q-pr-md q-mb-md"},[a("croppa",{ref:"croppary",staticClass:"text-center",attrs:{height:120,width:120,"initial-position":"center",placeholder:e.$t(""),"placeholder-font-size":19,"remove-button-size":23},on:{"new-image-drawn":function(t){return e.submitProductImage("croppary","left_image")}},model:{value:e.croppa,callback:function(t){e.croppa=t},expression:"croppa"}},[a("img",{staticClass:"img-responsive canvas-image",attrs:{slot:"placeholder",src:"/statics/placeholder.png",width:"40px"},slot:"placeholder"})])],1):e._e(),a("div",{staticClass:"col-xs-12 col-md-8"},[1===e.leftImages.length?a("div",{staticClass:"form-group"},[a("label",{domProps:{textContent:e._s(e.$t("Imágenes"))}}),a("div",{staticClass:"row"},e._l(e.leftImages,(function(t){return a("div",{key:t.id,staticClass:"col-xs-12 col-md-6 q-pa-sm"},[a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:e.appPath+"/images/tratamientos/"+t.name}}),a("q-card-actions",[a("q-btn",{attrs:{loading:e.loadingDeleteImg,icon:"delete",flat:"",color:"negative",size:"sm",disable:e.loadingDeleteImg},on:{click:function(a){return e.deleteImage(t.id)}}})],1)],1)],1)})),0)]):e._e()])]):e._e(),"service"===e.form.type?a("div",{staticClass:"row"},[a("div",{staticClass:"col-xs-12"},[a("small",[e._v("Cargar imágenes de peso menor a 1mb. Tamaño ideal ")])]),a("div",{staticClass:"col-xs-12"},[a("label",[e._v("Imagen lateral derecha\n                ")])]),0===e.rightImages.length?a("div",{staticClass:"col-xs-12 col-md-4 q-pr-md q-mb-md"},[a("croppa",{ref:"cropparytwo",staticClass:"text-center",attrs:{width:120,height:120,"initial-position":"center",placeholder:e.$t(""),"placeholder-font-size":19,"remove-button-size":23},on:{"new-image-drawn":function(t){return e.submitProductImage("cropparytwo","right_image")}},model:{value:e.croppaTwo,callback:function(t){e.croppaTwo=t},expression:"croppaTwo"}},[a("img",{staticClass:"img-responsive canvas-image",attrs:{slot:"placeholder",src:"/statics/placeholder.png",width:"40px"},slot:"placeholder"})])],1):e._e(),a("div",{staticClass:"col-xs-12 col-md-8"},[e.rightImages.length?a("div",{staticClass:"form-group"},[a("label",{domProps:{textContent:e._s(e.$t("Imágenes"))}}),a("div",{staticClass:"row"},e._l(e.rightImages,(function(t){return a("div",{key:t.id,staticClass:"col-xs-12 col-md-6 q-pa-sm"},[a("q-card",{staticClass:"my-card"},[a("q-img",{attrs:{src:e.appPath+"/images/tratamientos/"+t.name}}),a("q-card-actions",[a("q-btn",{attrs:{loading:e.loadingDeleteImg,icon:"delete",flat:"",color:"negative",size:"sm",disable:e.loadingDeleteImg},on:{click:function(a){return e.deleteImage(t.id)}},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}],null,!0)})],1)],1)],1)})),0)]):e._e()])]):e._e()])])]),a("q-card-section",{staticClass:"text-right"},[a("q-btn",{attrs:{label:"Cerrar",color:"primary",flat:""},on:{click:e.closeModal}}),a("q-btn",{attrs:{disable:e.loadingSave,icon:"save",label:"Guardar",color:"primary"},on:{click:e.save}})],1)],1)],1)],1)},r=[],o=a("967e"),s=a.n(o),n=(a("96cf"),a("fa84")),l=a.n(n),c=a("3786"),d=a("d66b"),m=a("2b0e"),p=a("b185"),u=a("2896"),g=a.n(u),f=a("b5ae"),v=f.required;f.minLength;m["a"].use(g.a);var h={name:"TreatmentsTable",components:{QRadio:c["a"],QEditor:d["a"],ReusableTable:p["default"]},data:function(){return{croppa:{},loadingDelete:!1,loadingSave:!1,croppaTwo:{},toDelete:{data:null,modal:!1},icons:[{title:"b-1.png",color:"#"},{title:"b-2.png",color:"#"},{title:"b-3.png",color:"#"},{title:"b-4.png",color:"#"},{title:"b-5.png",color:"#"},{title:"b-6.png",color:"#"},{title:"b-7.png",color:"#"},{title:"b-8.png",color:"#"},{title:"b-9.png",color:"#"}],form:{type:"service",title:null,id:null,contents:"",icon:null,oldImages:[]},tableName:"treatments-table",columns:[{name:"title",field:"title",label:"Titulo"},{name:"actions",field:"actions",label:"Acciones"}],playersData:[],filtersBag:[],submitOnChange:!0,loadingDeleteImg:!1,loading:!1,showModal:!1,moreParams:{selected:[],sortBy:"desc",descending:!1,page:1,rowsNumber:10,rowsPerPage:10,total:100}}},mounted:function(){},validations:{form:{title:{required:v},type:{required:v}}},computed:{appPath:function(){return"https://www.sabrinalainatti.com"},rightImages:function(){return this.form.oldImages.filter((function(e){return"right_image"===e.kind}))},leftImages:function(){return this.form.oldImages.filter((function(e){return"left_image"===e.kind}))}},methods:{editTreatment:function(){var e,t,a=arguments.length>1?arguments[1]:void 0;this.showModal=!0,this.form.id=a.id,this.form.title=a.title,this.form.icon=a.icon,this.form.oldImages=null!==(e=a.images)&&void 0!==e?e:[],this.form.type=a.type,this.form.contents=null!==(t=a.content)&&void 0!==t?t:""},closeModal:function(){this.showModal=!1,this.$events.fire("get-data")},deleteImage:function(e){var t=this;return l()(s.a.mark((function a(){var i;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loadingDeleteImg=!0,a.prev=1,a.next=4,t.$axios.post("api/v1/images/delete",{image_id:e,service_id:t.form.id});case 4:i=a.sent,t.form.oldImages=i.data.images,t.$events.fire("notify",i.data.msg),a.next=11;break;case 9:a.prev=9,a.t0=a["catch"](1);case 11:t.loadingDeleteImg=!1;case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},submitProductImage:function(e,t){var a=this;return l()(s.a.mark((function i(){var r;return s.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a.$refs[e].hasImage()){i.next=2;break}return i.abrupt("return");case 2:r=a,a.$refs[e].generateBlob((function(i){if(a.submitOnChange){var o,s=new FormData;s.append("image",a.$refs[e].getChosenFile()),s.append("service_id",null!==(o=a.form.id)&&void 0!==o?o:null),s.append("subtreatment_id",null),s.append("kind",t),s.append("type","service"),r.$q.loading.show({message:"Cargando imagen ..."}),r.$axios.post("api/v1/images/resource",s).then((function(t){r.$q.loading.hide(),r.$events.fire("notify",r.$t(t.data.msg)),t.data.error||(r.$refs[e].remove(),r.form.oldImages=t.data.images)})).catch((function(e){r.$q.loading.hide()}))}else a.$events.fire("image-change",i)}));case 4:case"end":return i.stop()}}),i)})))()},setIcon:function(e){this.form.icon=e.title},save:function(){var e=this;return l()(s.a.mark((function t(){var a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.$v.form.$touch(),e.$v.form.$error){t.next=12;break}return e.loadingSave=!0,e.$q.loading.show({message:"Guardando ..."}),t.next=7,e.$axios.post("api/v1/treatments/resource",e.form);case 7:a=t.sent,!1===a.data.error&&(e.showModal=!1),e.$q.loading.hide(),e.$events.fire("notify",a.data.msg),e.$events.fire("get-data");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),e.$q.loading.hide();case 17:return t.prev=17,e.loadingSave=!1,t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,14,17,20]])})))()},modalDeleteTreatment:function(){var e=arguments.length>1?arguments[1]:void 0;this.toDelete.data=e,this.toDelete.modal=!0},deleteTreatment:function(){var e=this;return l()(s.a.mark((function t(){var a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loadingDelete=!0,t.next=4,e.$axios.post("api/v1/treatments/delete",{treatment_id:e.toDelete.data.id});case 4:a=t.sent,e.$events.fire("notify",a.data.msg),!1===a.data.error&&(e.toDelete.modal=!1,e.$events.fire("get-data")),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:return t.prev=11,e.loadingDelete=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,9,11,14]])})))()}},events:{"create-treatment":function(){this.showModal=!0,this.form.title=null,this.form.type="service",this.form.icon=null,this.form.contents="",this.form.id=null},"edit-treatment":function(e,t){}}},b=h,w=(a("bd09"),a("2877")),x=Object(w["a"])(b,i,r,!1,null,"45d82bba",null);t["default"]=x.exports},bd09:function(e,t,a){"use strict";var i=a("0ea9"),r=a.n(i);r.a}}]);